# Assignment 3

1. ## 贝叶斯规则应用
>已知脑膜炎会导致患者 $70\%$ 的几率出现僵硬的脖子。如果任何患者患有脑膜炎的先验概率为 $ \frac{1}{50000} $ ，且任何患者出现僵硬的脖子的概率为 $1\%$ ，求一位出现僵硬脖子的患者实际患有脑膜炎的概率。

首先，我们设两个事件： $ A $ 表示患者患有脑膜炎， $ B $ 表示患者出现僵硬的脖子。

由题意得：
- $ P(A) = \frac{1}{50000} $：任意患者患有脑膜炎的先验概率。
- $ P(B|A) = 0.7 $：如果患者患有脑膜炎，则患者出现僵硬的脖子的概率。
- $ P(B) = 0.01 $：任意患者出现僵硬的脖子的概率。

要求 $ P(A|B) $，即求患者出现僵硬的脖子的情况下，患者实际患有脑膜炎的概率。

代入贝叶斯公式得：

$ P(A|B) = \cfrac{P(B|A) \cdot P(A)}{P(B)} = \cfrac{0.7 \cdot \frac{1}{50000}}{0.01} = 0.0014 = \boxed{0.14\%} $

因此，出现僵硬脖子的患者实际患有脑膜炎的概率是 $ 0.14\% $。

2. ## 贝叶斯网络推理 - 陷阱问题

>在探索一个未知地区的过程中，系统遇到三个方格，每个方格可能含有陷阱。系统检测到每个方格的附近有风的迹象，风的存在表明至少一个邻近方格可能有陷阱。假设每个方格有陷阱的先验概率为 $20\%$，已知：
>1. 陷阱引起风的条件概率是 $0.75$
>2. 无陷阱时引起风的概率是 $0.25$
>
>要求：使用贝叶斯推理，计算每个方格含有陷阱的概率。

首先，我们作出如下假设：

- 设 $ T_i $ 表示第 $ i $ 个方格含有陷阱（$ i \in \{1, 2, 3\} $）。
- $ P(T_i) = 0.2 $：每个方格含有陷阱的先验概率。
- 设 $ W $ 表示系统检测到风的迹象。
- $ P(W|T_i) = 0.75 $：如果第 $ i $ 个方格有陷阱，则检测到风的概率。
- $ P(W|\neg T_i) = 0.25 $：如果第 $ i $ 个方格没有陷阱，则检测到风的概率。

我们要求的是 $ P(T_i | W) $，即在检测到风的情况下，第 $ i $ 个方格含有陷阱的概率。可以使用贝叶斯定理：

$ P(T_i | W) = \frac{P(W | T_i) P(T_i)}{P(W)} $

首先，计算 $ P(W) $，即检测到风的总概率。我们需要考虑风的迹象可能由以下几种情况引起：
- 有一个或多个方格有陷阱。
- 所有方格都没有陷阱。

对于每个方格，我们考虑独立性，风的迹象可以由其中至少一个方格有陷阱引起。具体计算如下：

风迹象的总概率可以分解为：
$ P(W) = P(W | \text{至少一个方格有陷阱}) \cdot P(\text{至少一个方格有陷阱}) + P(W | \text{没有方格有陷阱}) \cdot P(\text{没有方格有陷阱}) $

其中，
- $ P(\text{至少一个方格有陷阱}) = 1 - P(\text{没有一个方格有陷阱}) $
- $ P(\text{没有一个方格有陷阱}) = (1 - 0.2)^3 = 0.8^3 = 0.512 $
- 因此，$ P(\text{至少一个方格有陷阱}) = 1 - 0.512 = 0.488 $

如果至少一个方格有陷阱，风的概率就是 $ 1 - P(\text{没有一个方格引起风}) $

$ P(W | \text{至少一个方格有陷阱}) = 1 - (1 - 0.75)^3 = 1 - 0.25^3 = 1 - 0.015625 = 0.984375 $

$ P(W | \text{没有方格有陷阱}) $：
$ P(W | \text{没有方格有陷阱}) = 0.25 $

因此，
$ P(W) = 0.984375 \cdot 0.488 + 0.25 \cdot 0.512 = 0.480390625 + 0.128 = 0.608390625 $

应用贝叶斯公式：
$ P(T_i | W) = \frac{P(W | T_i) P(T_i)}{P(W)} $

代入得：
$ P(T_i | W) = \frac{0.75 \cdot 0.2}{0.608390625} = \frac{0.15}{0.608390625} \approx 0.2465 $

综上，在检测到风的情况下，每个方格含有陷阱的概率约为 $ 24.65\% $。

3. ## 贝叶斯网络条件概率表 1
4. ## 贝叶斯网络条件概率表 2
5. ## 概率计算
6. ## 朴素贝叶斯